<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANÁLISE</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #e0f7fa; /* Azul Claro */
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background: white; /* Branco */
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        h1 {
            color: #333;
            text-align: center;
            border-bottom: 2px solid #e0f7fa;
            padding-bottom: 15px;
            margin-bottom: 30px;
            font-size: 2.2em;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        /* Cabeçalho do Resultado */
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            margin-bottom: 15px;
            border-left: 5px solid #ffebee;
            padding-left: 10px;
        }
        
        h2 {
            color: #555;
            font-size: 1.4em;
            margin: 0;
        }

        .btn-clear {
            background-color: transparent;
            border: 1px solid #ff8a80;
            color: #d32f2f;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s;
        }
        .btn-clear:hover {
            background-color: #ffebee;
        }
        
        .fields-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 650px) {
            .fields-grid {
                grid-template-columns: 1fr;
            }
        }

        .input-group {
            background-color: #ffebee; /* Rosa Claro */
            padding: 15px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #444;
            font-size: 0.95em;
        }
        select, input[type="text"], input[type="number"], input[type="month"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0f7fa; 
            border-radius: 4px;
            box-sizing: border-box;
            background-color: white; 
            font-size: 1em;
            color: #333;
            outline: none;
        }
        select:focus, input:focus {
            border-color: #b2dfdb;
        }
        
        .result-area {
            position: relative;
        }
        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0f7fa;
            border-radius: 6px;
            box-sizing: border-box;
            min-height: 250px;
            font-family: 'Roboto Mono', monospace;
            white-space: pre-wrap;
            background-color: #fff; 
            color: #263238; 
            font-size: 1.05em;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .btn-copy {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #e0f7fa; 
            color: #333;
            border: 2px solid #b2dfdb;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-copy:hover {
            background-color: #b2dfdb; 
        }
        .btn-copy:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ANÁLISE</h1>
    
    <div class="fields-grid">
        <div class="input-group">
            <label for="conteudo_site">Conteúdo do Site:</label>
            <select id="conteudo_site" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="Site com fotos do casal, infos da cerimonia e recepção">Site com fotos do casal, infos da cerimonia e recepção</option>
                <option value="Site com fotos do casal e lista de presentes ativa">Site com fotos do casal e lista de presentes ativa</option>
                <option value="Site sem fotos e com somente infos da cerimonia e recepção">Site sem fotos e com somente infos da cerimonia e recepção</option>
                <option value="Site com somente lista de presentes ativa">Site com somente lista de presentes ativa</option>
                <option value="Site sem edições">Site sem edições</option>
            </select>
        </div>

        <div class="input-group">
            <label for="lista_personalizada">Lista de presentes personalizada?</label>
            <select id="lista_personalizada" onchange="gerarRelatorio()">
                <option value="Não">Não</option>
                <option value="Sim">Sim</option>
            </select>
        </div>

        <div class="input-group">
            <label for="status_acessos">Status do Site/Acessos:</label>
            <select id="status_acessos" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="ok">ok</option>
                <option value="baixos mas ok">baixos mas ok</option>
                <option value="altos">altos</option>
            </select>
        </div>

        <div class="input-group">
            <label for="data_evento">Mês/Ano do Evento:</label>
            <input type="month" id="data_evento" onchange="gerarRelatorio()">
        </div>

        <div class="input-group">
            <label for="status_rsvp">Status do RSPV:</label>
            <select id="status_rsvp" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="fechada e com dados cadastrados">RSVP fechada e com dados cadastrados</option>
                <option value="fechada e sem dados cadastrados">RSVP fechada e sem dados cadastrados</option>
                <option value="aberta e com interações">RSVP aberta e com interações</option>
                <option value="aberta e sem interações">RSVP aberta e sem interações</option>
                <option value="pela Avip">RSVP pela Avip</option>
                <option value="não aplicável">RSVP Não Aplicável</option>
            </select>
        </div>

        <div class="input-group">
            <label for="dados_carteira">Coerência dos Dados da Carteira:</label>
            <select id="dados_carteira" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="coerentes ao CS">coerentes ao CS</option>
                <option value="incoerentes ao CS">incoerentes ao CS</option>
                <option value="Sem dados na carteira">Sem dados na carteira</option>
            </select>
        </div>

        <div class="input-group">
            <label for="chave_pix">Chave Pix Cadastrada:</label>
            <select id="chave_pix" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="Com chave Pix cadastrada em nome da noiva">Com chave Pix cadastrada em nome da noiva</option>
                <option value="Com chave Pix cadastrada em nome do noivo">Com chave Pix cadastrada em nome do noivo</option>
                <option value="Com chave Pix cadastrada em nome do casal">Com chave Pix cadastrada em nome do casal</option>
                <option value="Sem chave Pix cadastrada">Sem chave Pix cadastrada</option>
            </select>
        </div>

        <div class="input-group">
            <label for="qtd_presentes">Quantidade de Presentes Recebidos:</label>
            <input type="number" id="qtd_presentes" value="0" min="0" list="sugestao_qtd" oninput="gerarRelatorio()">
            <datalist id="sugestao_qtd">
                <option value="1"></option>
                <option value="2"></option>
                <option value="3"></option>
                <option value="4"></option>
                <option value="5"></option>
                <option value="6"></option>
                <option value="7"></option>
                <option value="8"></option>
                <option value="9"></option>
                <option value="10"></option>
                <option value="11"></option>
                <option value="12"></option>
                <option value="13"></option>
                <option value="14"></option>
                <option value="15"></option>
            </datalist>
        </div>

        <div class="input-group">
            <label for="meio_pagamento">Meio de pagamento:</label>
            <select id="meio_pagamento" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="via Pix">via Pix</option>
                <option value="via BT">via BT</option>
                <option value="via Pix e BT">via Pix e BT</option>
            </select>
        </div>

        <div class="input-group">
            <label for="recados">Recados:</label>
            <select id="recados" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="simples">simples</option>
                <option value="bacanas">bacanas</option>
                <option value="elaborados">elaborados</option>
                <option value="sem recados">sem recados</option>
            </select>
        </div>

        <div class="input-group">
            <label for="card">Card?</label>
            <select id="card" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="com card">com card</option>
                <option value="sem card">sem card</option>
            </select>
        </div>

        <div class="input-group">
            <label for="indicios_morango">Site tem indícios de morango?</label>
            <select id="indicios_morango" onchange="gerarRelatorio()">
                <option value="Não">Não</option>
                <option value="Sim">Sim</option>
            </select>
        </div>
        
        <div class="input-group">
            <label for="divulgacao">Divulgou o site?</label>
            <select id="divulgacao" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="Sim, faz sentido">Sim, faz sentido</option>
                <option value="Não">Não</option>
            </select>
        </div>

        <div class="input-group">
            <label for="apontamentos">Apontamentos Adicionais:</label>
            <select id="apontamentos" onchange="gerarRelatorio()">
                <option value="">-- Selecione --</option>
                <option value="Sem mais apontamentos">Sem mais apontamentos</option>
                <option value="Manterei em revisão">Manterei em revisão</option>
                <option value="Manterei flag">Manterei flag</option>
                <option value="Morango real">Morango real</option>
            </select>
        </div>
    </div>

    <div class="result-header">
        <h2>Resultado</h2>
        <button class="btn-clear" onclick="limparTudo()">Limpar tudo</button>
    </div>
    
    <div class="result-area">
        <textarea id="output-relatorio" readonly></textarea>
        <button class="btn-copy" onclick="copiarTexto()">Copiar Resultado</button>
    </div>
</div>

<script>
    function gerarRelatorio() {
        // --- Captura de Dados ---
        const conteudo = document.getElementById('conteudo_site').value;
        const listaPersonalizada = document.getElementById('lista_personalizada').value;
        const acessos = document.getElementById('status_acessos').value;
        const dataInput = document.getElementById('data_evento').value;
        const rsvp = document.getElementById('status_rsvp').value;
        const carteira = document.getElementById('dados_carteira').value;
        const pix = document.getElementById('chave_pix').value;
        const qtdPresentes = parseInt(document.getElementById('qtd_presentes').value) || 0;
        const meioPagamento = document.getElementById('meio_pagamento').value;
        const recados = document.getElementById('recados').value; 
        const card = document.getElementById('card').value;         
        const indiciosMorango = document.getElementById('indicios_morango').value;
        const divulgacao = document.getElementById('divulgacao').value;
        const apontamentos = document.getElementById('apontamentos').value;
        
        const NL = '\n\n'; 
        let relatorio = '';

        // Formatação Data
        let dataFormatada = '';
        if (dataInput) {
            const partes = dataInput.split('-');
            const ano = partes[0];
            const mes = partes[1];
            dataFormatada = `${mes}/${ano}`;
        }

        const rsvpFormatado = rsvp ? rsvp.toLowerCase() : '';
        const qtdFormatada = qtdPresentes.toString().padStart(2, '0');

        // GATILHO
        if (!acessos) {
            document.getElementById('output-relatorio').value = '';
            return; 
        }

        // P1: Conteúdo, Lista, Acessos, Data, RSVP
        let p1 = '';
        if (conteudo) p1 += conteudo + ".";
        if (listaPersonalizada === "Sim") p1 += " Lista de presentes com itens personalizados.";
        
        p1 += " Acessos " + acessos;

        if (dataFormatada) {
             p1 += " para evento em " + dataFormatada + ".";
        } else {
             p1 += " para evento em ."; 
        }

        if (rsvpFormatado) {
            p1 += " RSPV " + rsvpFormatado + ".";
        } else {
            p1 += " RSPV .";
        }
        
        relatorio += p1 + NL;

        // P2: Carteira e Pix
        let p2 = '';
        if (carteira) {
            if (carteira === "Sem dados na carteira") {
                p2 += "Sem dados na carteira.";
            } else {
                p2 += "Dados na carteira são " + carteira + ".";
            }
            
            if (pix) {
                p2 += " " + pix + ".";
            }
        }
        if (p2) relatorio += p2 + NL;

        // P3: Presentes + Meio de Pagamento + Recados + Card
        if (qtdPresentes > 0) {
            // Lógica Singular/Plural
            let termoPresente = (qtdPresentes === 1) ? "presente" : "presentes";
            
            let textoMeioPagamento = meioPagamento ? (" " + meioPagamento) : "";
            
            let textoRecadosCard = "";
            if (recados) {
                if (recados !== "sem recados") { // CORREÇÃO: Não inclui a palavra "recados" se a opção for "sem recados"
                    let verboRecados = (qtdPresentes === 1) ? "é" : "são";
                    textoRecadosCard += `, recados ${verboRecados} ${recados}`;
                } else {
                    textoRecadosCard += `, ${recados}`; // Se for "sem recados", apenas concatena a vírgula e a frase.
                }
            }

            if (card) {
                textoRecadosCard += ` e ${card}`;
            }

            // Frase final P3
            relatorio += "Receberam " + qtdFormatada + " " + termoPresente + textoMeioPagamento + textoRecadosCard + ". Dados são coerentes." + NL;
        }

        // P4: Morango
        if (indiciosMorango === "Sim") {
            relatorio += "Site tem fortes indicios de morango, reembolsarei as compras, adicionarei dados na lista de restrição e tratarei como tal." + NL;
        }

        // P5: Divulgação
        if (divulgacao === "Sim, faz sentido") {
            relatorio += "Os acessos indicam que o casal divulgou o site, então faz sentido que tenham recebido presentes e realizadas após x dias da criação do site." + NL;
        }

        // P6: Apontamentos
        if (apontamentos) {
            let conclusao = apontamentos;
            
            if (apontamentos === "Manterei em revisão" || apontamentos === "Manterei flag") {
                // CORREÇÃO: Adiciona ", pois" nas opções de manutenção
                conclusao += ", pois";
            } else if (apontamentos === "Sem mais apontamentos") {
                conclusao += ", liberado.";
            } else {
                conclusao += ".";
            }
            relatorio += conclusao;
        }

        document.getElementById('output-relatorio').value = relatorio.trim();
    }

    function limparTudo() {
        const selects = document.querySelectorAll('select');
        const inputs = document.querySelectorAll('input');

        selects.forEach(select => {
            if(select.id === 'lista_personalizada' || select.id === 'indicios_morango') {
                select.value = "Não";
            } else {
                select.selectedIndex = 0;
            }
        });

        inputs.forEach(input => {
            if (input.type === 'number') {
                input.value = 0;
            } else {
                input.value = '';
            }
        });

        document.getElementById('output-relatorio').value = '';
        gerarRelatorio(); 
    }

    function copiarTexto() {
        const textarea = document.getElementById('output-relatorio');
        textarea.select();
        textarea.setSelectionRange(0, 99999); 
        navigator.clipboard.writeText(textarea.value).then(() => {
            const btn = document.querySelector('.btn-copy');
            const textoOriginal = btn.innerText;
            btn.innerText = "Copiado!";
            btn.style.backgroundColor = "#b2dfdb";
            
            setTimeout(() => {
                btn.innerText = textoOriginal;
                btn.style.backgroundColor = "#e0f7fa";
            }, 2000);
        });
    }

    window.onload = gerarRelatorio;
</script>

</body>
</html>